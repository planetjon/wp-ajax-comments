!function(){var m,e,t;function n(){fetch(wac_env.ajaxurl+"?action=wac_load_comments&postID="+e).then(function(e){return e.ok&&e.text()}).then(function(e){m.innerHTML=e;var t=document.getElementById("respond"),n=document.getElementById("commentform").querySelector(".form-submit"),o=document.createElement("input");o.type="reset",o.value="Cancel";e=document.createElement("div");e.id="respond-anchor",t.after(e),n.append(o)})}function o(e,t,n,o){e.addEventListener(t,function(e){e.target.matches(n)&&o(e)})}(m=document.getElementById("wac-stub"))&&(e=m.dataset.postid,o(m,"click",".comment-reply-link",function(e){var t,n;e.preventDefault(),t=e.target,n=t.dataset.commentid,e=t.dataset.belowelement,t=document.getElementById("respond"),document.getElementById("comment_parent").value=n,document.getElementById(e).after(t),document.getElementById(e).scrollIntoView({behavior:"smooth"})}),o(m,"submit","#commentform",function(e){var t,n;e.preventDefault(),e=e.target,t=new FormData(e),(n=document.createElement("div")).style="margin:1em",fetch(e.action,{method:e.method,redirect:"manual",body:t}).then(function(e){return e.status?Promise.reject():(n.innerHTML="<p><small>"+wac_env.pending_msg+"</small></p>",void(n.innerHTML+=t.get("comment")))}).catch(function(){n.innerHTML=wac_env.error_msg}).finally(function(){document.getElementById("respond").before(n),document.getElementById("commentform").reset()})}),o(m,"reset","#commentform",function(e){var t;t=document.getElementById("respond"),document.getElementById("comment_parent").value="",document.getElementById("respond-anchor").before(t)}),"IntersectionObserver"in window?(t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(n(),t.unobserve(e.target))})})).observe(m):n())}();
